<!DOCTYPE html>
<html>
<head>
    <title>{{ title }}</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel="stylesheet" type="text/css" href="/scripts/semantic.min.css">
    <script src="/scripts/semantic.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var socket = io.connect("");

            socket.on('connect', function (data) {
                socket.emit('beConnect', {msg : "hello server"});
                socket.on('mongodata', function (mongodata) {
                    mongodata.data.forEach(function (item, index, array) {
                        var divid = item.uuid + item.subscribeKey + item.publishKey + item.channelName + item.email;
                        divid = divid.split('').reverse().join('').split('@').join('').split('.').join('');
                        $("#" + divid).addClass('user-online');
                    })
                })
            })

            socket.on('beUserOnline', function (data) {
                console.log('user online event');
                var ele = data.tagid.toString();
                console.log(ele);
                $("#" + ele).addClass('user-online');
            });

            socket.on('beUserOffline', function (data) {
                console.log('user offline event');
                var ele = data.tagid.toString();
                console.log(ele);
                $("#" + ele).removeClass('user-online');
            });

            socket.on('disconnect',function (data) {
                window.alert("Server disconnected. Please refresh the page.");
                socket.disconnect();
            })
        })
    </script>
    <style type="text/css">
         ul { display:table; margin:0 auto;}
        .list{text-align:center}
        .list ul{
            display:inline-block;
            text-align:left;
        }
    </style>
</head>
<body>
<div class="row" id="msg"></div>
<div class="ui large menu">
    <a class="active item">
        Home
    </a>
    <div class="right menu">
        <form class="item" action="logout">
            <button class="ui primary button">Logout</button>
        </form>
    </div>
</div>
<center>
<h2 class="ui header">
    <img src="/images/avatar/user1.png" class="ui circular image">
    {{user}}
</h2>
<h3 class="ui header">No. of connected gateways : {{connected_gateways}}</h3>

<h3 class="ui header">Connected gateways details : </h3>
    <br><br>

</center>

{{{usersList}}}

</body>
</html>
